# Rsyslog configuration for syslog collection and Splunk HEC forwarding
# Generated by Ansible - do not edit manually

# Load required modules
module(load="imudp")
module(load="imtcp")
module(load="omprog")

# Listen for syslog on configured port
{% for protocol in cribl_stream_syslog_protocols %}
{% if protocol == 'udp' %}
input(type="imudp" port="{{ cribl_stream_syslog_port }}")
{% elif protocol == 'tcp' %}
input(type="imtcp" port="{{ cribl_stream_syslog_port }}")
{% endif %}
{% endfor %}

# Forward all syslog to Splunk HEC via omprog
*.* action(
    type="omprog"
    binary="/usr/local/bin/splunk-hec-forwarder.sh"
    template="RSYSLOG_TraditionalFileFormat"
)
