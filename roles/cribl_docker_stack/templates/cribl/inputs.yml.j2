---
# Cribl Edge inputs configuration
# Generated by Ansible - cribl_docker_stack role

inputs:
{% for port in cribl_docker_stack_syslog_ports %}
  # Syslog TCP listener on port {{ port }}
  syslog:in_syslog_{{ port }}_tcp:
    id: in_syslog_{{ port }}_tcp
    type: syslog
    disabled: false
    pipeline: syslog
    sendToRoutes: true
    host: "0.0.0.0"
    port: {{ port }}
    tls:
      disabled: true
    maxActiveCxn: 100
    enableProxyHeader: false
    captureHeaders: false
    activityLogSampleRate: 100
    enableMultiline: false
    pqEnabled: true

  # Syslog UDP listener on port {{ port }}
  syslog:in_syslog_{{ port }}_udp:
    id: in_syslog_{{ port }}_udp
    type: syslog
    disabled: false
    pipeline: syslog
    sendToRoutes: true
    host: "0.0.0.0"
    port: {{ port }}
    udpMode: true
    enableProxyHeader: false
    captureHeaders: false
    activityLogSampleRate: 100
    enableMultiline: false
    pqEnabled: true

{% endfor %}
  # NetFlow UDP listener on port {{ cribl_docker_stack_netflow_port }}
  netflow:in_netflow:
    id: in_netflow
    type: netflow
    disabled: false
    pipeline: syslog
    sendToRoutes: true
    host: "0.0.0.0"
    port: {{ cribl_docker_stack_netflow_port }}
    pqEnabled: true
