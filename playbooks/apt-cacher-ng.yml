---
# Apt-Cacher-NG Deployment Playbook
# Installs and configures apt-cacher-ng caching proxy

- name: Deploy Apt-Cacher-NG
  hosts: apt_cacher_group
  become: true
  gather_facts: true

  roles:
    - apt_cacher_ng

  post_tasks:
    - name: Display client configuration instructions
      ansible.builtin.debug:
        msg:
          - "Apt-Cacher-NG deployed successfully!"
          - ""
          - "To configure clients to use this proxy, run on each client:"
          - ""
          - "  echo 'Acquire::http::Proxy \"http://{{ inventory_hostname }}:{{ apt_cacher_ng_port }}\";' \\"
          - "    | sudo tee /etc/apt/apt.conf.d/00proxy"
          - ""
          - "Admin interface: http://{{ inventory_hostname }}:{{ apt_cacher_ng_port }}/{{ apt_cacher_ng_report_page }}"
